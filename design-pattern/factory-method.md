### 工厂方法模式

Factory Mehthod，亦称虚拟构造函数，Virtual Constructor。

工厂方法模式是一种创建型设计模式，在父类中提供一个创建对象的（工厂）方法，允许子类（通过重写工厂方法）决定实例化对象的类型。

工厂方法模式建议使用特殊的工厂方法代替直接调用对象构造函数。工厂方法返回的对象通常被称作“**产品**”。可以在工厂的子类中重写工厂方法，从而改变其创建产品的类型。

仅当产品具有共同的基类或者接口的时候，子类才能返回不同类型的产品，同时基类中的工厂方法还应将其返回类型声明为这一共有接口。

#### 1、工厂方法模式结构

![工厂方法模式结构](/assets/structure.png)

**产品** 接口（Product） 将会对接口功能进行声明。 对于所有由创建者及其子类构建的对象， 这些接口方法都是通用的。

**创建者** （Creator） 类声明返回产品对象的工厂方法 `createProduct()`， 该方法的返回对象类型必须与产品接口相匹配。可以将工厂方法声明为抽象方法，强制要求每个子类以不同方式实现该方法，也可以在基础工厂方法中返回默认产品类型。需要注意的是，创建者的职责不是创建产品——它只是声明一些与产品相关的核心业务逻辑。

**具体创建者** （Concrete Creators） 将会重写基础工厂方法， 使其返回不同类型的产品。注意，并不一定每次调用工厂方法都去创建新的实例对象，工厂方法也可以返回缓存、对象池或者其他来源的已有对象。

实例，不同方式的物流运输；同应用在不同系统的UI实现。

#### 工厂方法模式适用场景：

- 编码过程中，无法预知对象确切类别及其依赖关系时，可以使用工厂方法，比如电商平台需要新增产品。
- 希望用户扩展软件库或框架的内部组件
- 希望复用现有对象来节省系统资源，而不是每次都重新创建对象，比如数据连接、文件系统和网络资源

#### 工厂方法模式优缺点：

##### 优点：

- 避免创建者和具体产品之间的紧密耦合
- 单一职责原则——将产品创建代码放在程序的单一位置，使得代码更易维护
- 开闭原则，无需更改现有客户端代码，可以在程序中引入新的产品类型。

##### 缺点：

应用工厂方法需要引入许多新的子类，代码可能会因此变得更复杂。